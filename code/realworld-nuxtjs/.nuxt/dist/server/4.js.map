{"version":3,"file":"4.js","sources":["webpack:///./api/article.js","webpack:///./pages/editor/index.vue?f25c","webpack:///./pages/editor/index.vue","webpack:///./pages/editor/index.vue?9495","webpack:///./pages/editor/index.vue?30d5"],"sourcesContent":["import { request } from '@/plugins/request'\n\n// 文章列表\nexport const getArticle = params => {\n  return request({\n    method: 'GET',\n    url: '/api/articles',\n    params\n  })\n}\n\n// 文章列表\nexport const getYourFeedArticle = params => {\n  return request({\n    method: 'GET',\n    url: '/api/articles/feed',\n    params\n  })\n}\n// 文章列表\nexport const addFavorite = slug => {\n  return request({\n    method: 'post',\n    url: `/api/articles/${slug}/favorite` \n  })\n}\n// 文章列表\nexport const deletelFavorite = slug => {\n  return request({\n    method: 'DELETE',\n    url: `/api/articles/${slug}/favorite`\n  })\n}\n// 文章详情内容\nexport const getArticleContent = slug => {\n  return request({\n    method: 'get',\n    url: `/api/articles/${slug}`\n  })\n}\n\n// 获取文章评论\nexport const getComments = slug => {\n  return request({\n    method: 'get',\n    url: `/api/articles/${slug}/comments`\n  })\n}\n\n// 添加文章评论\nexport const addComments = (slug, data) => {\n  return request({\n    method: 'post',\n    url: `/api/articles/${slug}/comments`,\n    data\n  })\n}\n\n// 删除文章评论\nexport const delComments = (slug, id) => {\n  return request({\n    method: 'DELETE',\n    url: `/api/articles/${slug}/comments/${id}`\n  })\n}\n\n// 新建文章\nexport const createArticle = data => {\n  return request({\n    method: 'POST',\n    url: `/api/articles`,\n    data\n  })\n}\n\n// 重新编辑文章\nexport const updateArticle = data => {\n  return request({\n    method: 'PUT',\n    url: `/api/articles/${data.article.slug}`,\n    data\n  })\n}\n\n// 删除文章\nexport const deleteArticle = slug => {\n  return request({\n    method: 'DELETE',\n    url: `/api/articles/${slug}`\n  })\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"editor-page\"},[_vm._ssrNode(\"<div class=\\\"container page\\\"><div class=\\\"row\\\"><div class=\\\"col-md-10 offset-md-1 col-xs-12\\\"><ul class=\\\"error-messages\\\">\"+(_vm._ssrList((_vm.errors),function(messages,field){return ((_vm._ssrList((messages),function(msg,index){return (\"<li>\"+_vm._ssrEscape(_vm._s(field)+\" \"+_vm._s(msg))+\"</li>\")})))}))+\"</ul> <form><fieldset><fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"Article Title\\\" required=\\\"required\\\"\"+(_vm._ssrAttr(\"value\",(_vm.article.title)))+\" class=\\\"form-control form-control-lg\\\"></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"What's this article about?\\\" required=\\\"required\\\"\"+(_vm._ssrAttr(\"value\",(_vm.article.description)))+\" class=\\\"form-control\\\"></fieldset> <fieldset class=\\\"form-group\\\"><textarea rows=\\\"8\\\" placeholder=\\\"Write your article (in markdown)\\\" required=\\\"required\\\" class=\\\"form-control\\\">\"+_vm._ssrEscape(_vm._s(_vm.article.body))+\"</textarea></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"Enter tags\\\"\"+(_vm._ssrAttr(\"value\",(_vm.article.tag)))+\" class=\\\"form-control\\\"> <div class=\\\"tag-list\\\">\"+(_vm._ssrList((_vm.article.tagList),function(tag){return (\"<span class=\\\"tag-default tag-pill ng-binding ng-scope\\\"><i class=\\\"ion-close-round\\\"></i>\"+_vm._ssrEscape(\"\\n                \"+_vm._s(tag)+\"\\n              \")+\"</span>\")}))+\"</div></fieldset> <button type=\\\"button\\\" class=\\\"btn btn-lg pull-xs-right btn-primary\\\">Publish Article</button></fieldset></form></div></div></div>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { createArticle, getArticleContent, updateArticle } from \"@/api/article\";\nexport default {\n  name: \"EditorPage\",\n  middleware: \"authenticated\",\n    async asyncData({ params }){\n      let articleInfo\n      let err\n      try {\n        if (params && params.slug) {\n          const { data } = await getArticleContent(params.slug)\n          articleInfo = data.article    \n        }\n      } catch (error) {\n        err = true\n      }\n      // console.log(err)\n      return {\n        articleInfo,\n        err\n      }\n    },\n  data() {\n    return {\n      article: {\n        title: \"\",\n        description: \"\",\n        body: \"\",\n        tag: '',\n        tagList: []\n      },\n      errors: {}\n    };\n  },\n  created () {\n    if(this.articleInfo) this.article = this.articleInfo\n    //首次获取文章数据时出错，跳转到首页\n    if(this.err) this.$router.push('/')\n  },\n  methods: {\n    async onSubmit() {\n      try {       \n        const { data } = this.article.slug \n        ? await updateArticle({\n            article: this.article\n          })\n        : await createArticle({\n            article: this.article\n          })\n        this.$router.push(`/article/${data.article.slug}`)\n      } catch (error) {\n        this.errors = error.response.data.errors;\n      }\n    },\n    addTag() {\n      const article = this.article\n      article.tagList.push(article.tag)\n      article.tag = \"\"\n      return false\n    }\n  }\n};\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=7a1eafc2&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  \"d13a9718\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAEA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAEA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAEA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAEA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAEA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAEA;AACA;AACA;AACA;AAFA;AAIA;;;;;;;;;;;;AC1FA;AACA;AACA;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AARA;AAUA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AADA;AAIA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AArBA;AArCA;;ACjEA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}